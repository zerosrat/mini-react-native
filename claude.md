# Mini React Native - Claude 开发指导

## 🎯 项目定位与原则

### 最小可行实现（MVP）指导原则

本项目是一个 **学习型的最小可行实现**，旨在通过构建简化版 React Native 来深度理解其核心原理。

**核心原则：**

1. **理解原理优先** > 完美实现
   - 重点是掌握 Bridge 通信、JS 引擎集成、视图渲染等核心机制
   - 不追求生产级的健壮性和性能优化
   - 代码可读性和教学价值优先于执行效率

2. **最小可行功能** > 功能完整性
   - 实现核心功能的最简版本，能跑通整个流程即可
   - 先建立端到端的通信，再逐步完善细节
   - 避免过度设计和提前优化

3. **快速迭代验证** > 一次性完美
   - 分阶段递增式开发，每个阶段都有可运行的成果
   - 尽快建立反馈循环，验证设计思路
   - 允许后续重构和改进

4. **AI 协助开发** > 纯手工编码
   - 利用 AI 生成大部分基础代码和样板代码
   - 人工专注于架构设计和核心逻辑
   - 显著提升开发效率，缩短实现周期

## 🔧 开发策略

### 质量标准

- **功能性**: 核心功能能正常工作，覆盖主要使用场景
- **稳定性**: 基本的错误处理，避免崩溃，但不追求完美的异常处理
- **性能**: 满足基本可用性即可，不做深度性能优化
- **代码质量**: 清晰易懂，有基础注释，便于学习和理解

### 平台优先级

1. **优先**: macOS (开发和测试便利)
2. **次要**: iOS (移动端验证)
3. **可选**: Android (跨平台完整性)

### 技术栈简化

- **JavaScript 引擎**: 使用系统 JavaScriptCore，避免复杂的引擎配置
- **构建系统**: 简单的 CMake + Makefile，不追求复杂的构建优化
- **测试策略**: 手动测试 + 简单的自动化验证，不追求完整的测试覆盖

## 🏗️ 架构约束

### 基于 React Native 老架构

本项目严格基于 **React Native 传统 Bridge 架构**（RN 0.60 之前的经典架构），不是新的 JSI/TurboModules 架构。

**核心约束：**

1. **架构思路与 RN 保持一致**
   - 遵循官方 RN Bridge 的设计模式和数据流向
   - JavaScript ↔ Native 通信必须基于异步消息队列
   - 模块注册和方法导出方式与 RN 保持一致

2. **具体实现可以简化**
   - 在保持架构思路一致的前提下，实现细节可以更简单
   - 减少复杂的优化和边缘情况处理
   - 专注核心流程，忽略生产级的健壮性要求

### 关键组件对应关系

| 组件 | React Native 原版 | Mini 实现 | 一致性要求 |
|------|------------------|-----------|------------|
| **JSCExecutor** | JSCExecutor.cpp | 简化版 JSCExecutor | JavaScript 上下文管理方式一致 |
| **MessageQueue** | MessageQueue.js | 简化版 MessageQueue | 消息格式和队列机制一致 |
| **NativeModule** | NativeModule.java/.mm | 简化版 NativeModule | 模块注册和方法调用方式一致 |
| **EventEmitter** | RCTEventEmitter | 简化版事件系统 | 事件分发机制一致 |

### 兼容性目标

- **消息格式兼容**: 能够处理标准 RN 的消息队列格式
- **模块接口兼容**: Native 模块的导出方式与 RN 保持一致
- **JavaScript 接口兼容**: 能够运行基础的 RN-style JavaScript 代码
- **事件系统兼容**: 事件的注册、监听、分发与 RN 行为一致

## 📅 时间管理

### 总体目标

- **阶段1 (Bridge通信)**: 7-10天 (而非原计划的 19-27天)
- **快速原型**: 2-3天内建立基础通信
- **功能完善**: 4-5天完善核心功能
- **验证测试**: 1-2天集成测试

### 里程碑设定

每个里程碑都应该有可演示的成果：
- **M1**: JavaScript 能调用一个 Native 函数并获得返回值
- **M2**: Native 能向 JavaScript 发送事件
- **M3**: 完整的 DeviceInfo 模块演示
- **M4**: 性能基准和文档总结

## 🚀 成功标准

### 最小成功标准 (Must Have)

- [x] JavaScript ↔ Native 双向通信正常工作
- [x] 至少一个完整的 Native 模块实现 (DeviceInfo)
- [x] 基础的错误处理机制
- [x] 可运行的端到端演示

### 期望标准 (Should Have)

- [x] 性能达到可接受水平 (< 10ms 调用延迟)
- [x] 事件系统正常工作
- [x] 基础的调试和日志功能
- [x] 与 React Native 行为对比分析

### 理想标准 (Could Have)

- [x] 多平台支持 (macOS + iOS)
- [x] 性能优化和内存管理
- [x] 完整的文档和教程
- [x] 开源社区反馈

## 📝 文档输出

### 必需文档

1. **实现文档**: 记录关键技术决策和实现细节
2. **使用指南**: 如何构建、运行和测试项目
3. **对比分析**: 与官方 React Native 的差异分析

### 期望文档

1. **技术博客**: 深度解析文章
2. **视频演示**: 关键功能的演示视频
3. **学习笔记**: 开发过程中的技术收获

---

**记住：这是一个学习项目，不是生产项目。保持简单，专注核心，快速迭代！**